<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trang Chủ - Đặc Sản Việt</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" th:href="@{/css/header.css(v=1)}">
    <link rel="stylesheet" th:href="@{/css/modern-ecommerce.css(v=1)}">
    
    <!-- Common Styles -->
    <style>
        :root {
            --primary-color: #D2691E;
            --primary-dark: #8B4513;
            --secondary-color: #34495e;
            --accent-color: #6B8E23;
            --light-bg: #f8f9fa;
            --dark-bg: #2c3e50;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
        }
        
        /* Common animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .animate-fade-in-up {
            animation: fadeInUp 0.6s ease-out;
        }
        
        .animate-delay-1 { animation-delay: 0.1s; }
        .animate-delay-2 { animation-delay: 0.2s; }
        .animate-delay-3 { animation-delay: 0.3s; }
        .animate-delay-4 { animation-delay: 0.4s; }
    </style>
</head>
<body>
    <!-- Header -->
    <div th:replace="~{fragments/header :: header}"></div>
    
    <!-- Mobile Menu -->
    <div th:replace="~{fragments/header :: mobile-menu}"></div>
    
    <style>
        /* Page-specific styles for index.html */
        
        /* Product Card Hover & Description Styles */
        .product-card {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1) !important;
            transform-style: preserve-3d !important;
        }
        
        .product-card:hover {
            transform: translateY(-8px) scale(1.03) !important;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15) !important;
        }
        
        /* 3D Effect for Featured Products Section */
        section.featured-products-section .product-card {
            perspective: 1000px !important;
            transform-style: preserve-3d !important;
            transition: transform 0.1s ease-out !important;
        }
        
        section.featured-products-section .product-card .card-body {
            transform-style: preserve-3d !important;
        }
        
        section.featured-products-section .card.product-card {
            perspective: 1000px !important;
            transform-style: preserve-3d !important;
            transition: transform 0.1s ease-out !important;
        }
        
        /* Product Image Hover Effect - Show Second Image */
        .product-img-container {
            position: relative !important;
            overflow: hidden !important;
        }
        
        .product-img {
            transition: opacity 0.4s ease-in-out !important;
        }
        
        .product-img-hover {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            object-fit: cover !important;
            opacity: 0 !important;
            transition: opacity 0.4s ease-in-out !important;
        }
        
        .product-card:hover .product-img-hover {
            opacity: 1 !important;
        }
        
        .product-card .card-text {
            display: -webkit-box !important;
            -webkit-line-clamp: 2 !important;
            -webkit-box-orient: vertical !important;
            overflow: hidden !important;
            text-overflow: ellipsis !important;
            line-height: 1.5 !important;
            min-height: 3em !important;
            margin-bottom: 1rem !important;
        }
        
        .product-card .card-text p {
            margin: 0 !important;
            display: inline !important;
        }
        
        .product-card .card-text p:not(:last-child)::after {
            content: " " !important;
        }
        
        /* Category Card Hover Effects */
        .category-card-hover {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .category-card-hover:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.2) !important;
        }
        
        .category-card-hover:hover img {
            transform: scale(1.1);
        }
        
        .category-card-hover .position-absolute {
            transition: all 0.3s ease;
        }
        
        .category-card-hover:hover .position-absolute {
            background: linear-gradient(to bottom, rgba(78, 194, 182, 0.3), rgba(78, 194, 182, 0.7)) !important;
        }
        
        /* Hero Slider Styles */
        .hero-slider {
            position: relative;
        }
        
        .hero-slide {
            height: 60vh;
            min-height: 500px;
            max-height: 700px;
            display: flex;
            align-items: center;
            position: relative;
            background-attachment: scroll;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }
        
        .min-vh-75 {
            min-height: 75vh;
        }
        
        .carousel-control-prev,
        .carousel-control-next {
            width: 5%;
            opacity: 0.8;
        }
        
        .carousel-control-prev:hover,
        .carousel-control-next:hover {
            opacity: 1;
        }
        
        .carousel-indicators {
            bottom: 30px;
        }
        
        .carousel-indicators [data-bs-target] {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin: 0 5px;
        }
        
        /* Modern Cards - Enhanced 3D Effects */
        .modern-card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            border: none;
            overflow: hidden;
            transform-style: preserve-3d;
            perspective: 1000px;
        }
        
        .modern-card:hover {
            transform: translateY(-15px) rotateX(5deg) rotateY(5deg);
            box-shadow: 0 25px 50px rgba(0,0,0,0.2);
        }
        
        .modern-card .card-body {
            transform: translateZ(20px);
        }
        
        .modern-card .product-img {
            transition: transform 0.4s ease;
        }
        
        .modern-card:hover .product-img {
            transform: scale(1.05);
        }
        
        .category-card {
            position: relative;
            height: 300px;
            background: linear-gradient(45deg, var(--primary-color), var(--accent-color));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
        }
        
        .category-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.2);
            transition: opacity 0.3s ease;
        }
        
        .category-card:hover::before {
            opacity: 0;
        }
        
        .category-card:hover {
            color: white;
            text-decoration: none;
        }
        
        .category-content {
            position: relative;
            z-index: 2;
            text-align: center;
        }
        
        .category-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            display: block;
        }
        
        .category-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .category-desc {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        /* Product Cards - Enhanced 3D Effects */
        .product-card {
            height: 100%;
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            cursor: pointer;
            transform-style: preserve-3d;
            display: flex !important;
            flex-direction: column !important;
        }
        
        .product-card .card-body {
            display: flex !important;
            flex-direction: column !important;
            flex: 1 !important;
        }
        
        .product-card .card-body .card-text {
            flex: 1 !important;
            min-height: 3rem;
        }
        
        .product-card .position-relative {
            flex-shrink: 0;
        }
        
        .product-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }
        
        .product-img {
            height: 250px;
            object-fit: cover;
            border-radius: 15px 15px 0 0;
            transition: all 0.4s ease;
        }
        
        .product-card:hover .product-img {
            transform: scale(1.1);
        }
        
        .product-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            z-index: 3;
            transition: transform 0.3s ease;
        }
        
        .product-card:hover .product-badge {
            transform: scale(1.1);
        }
        
        .price-tag {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--primary-color);
            transition: color 0.3s ease;
        }
        
        .product-card:hover .price-tag {
            color: var(--accent-color);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .hero-title {
                font-size: 2.5rem;
            }
            
            .hero-subtitle {
                font-size: 1.1rem;
            }
            
            .category-card {
                height: 200px;
            }
            
            .category-icon {
                font-size: 3rem;
            }
        }
        
        /* News Section Styles */
        .news-item {
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }
        
        .news-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.1) !important;
            border-color: var(--primary-color);
        }
        
        .news-item img {
            transition: transform 0.3s ease;
        }
        
        .news-item:hover img {
            transform: scale(1.05);
        }
        
        /* Social Media Buttons */
        .btn-primary, .btn-danger, .btn-info, .btn-dark {
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn-primary:hover, .btn-danger:hover, .btn-info:hover, .btn-dark:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        /* Contact Form Styles */
        .consultation-form .form-control {
            border-radius: 10px;
            border: 2px solid #e9ecef;
            padding: 12px 15px;
            transition: all 0.3s ease;
        }
        
        .consultation-form .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(231, 76, 60, 0.25);
            transform: translateY(-2px);
        }
        
        .consultation-form .btn {
            border-radius: 10px;
            transition: all 0.3s ease;
        }
        
        .consultation-form .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        /* Section Titles */
        .section-title {
            font-weight: 700;
            margin-bottom: 1rem;
            position: relative;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            border-radius: 2px;
        }
    </style>
    
    <!-- Hero Slider Section -->
    <section class="hero-slider">
        <div id="heroCarousel" class="carousel slide" data-bs-ride="carousel" data-bs-interval="5000">
            <div class="carousel-indicators">
                <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="0" class="active"></button>
                <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="1"></button>
                <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="2"></button>
            </div>
            
            <div class="carousel-inner">
                <!-- Slide 1 -->
                <div class="carousel-item active">
                    <div class="hero-slide" th:style="'background: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url(' + @{/images/slider/slider-1.webp} + ') center/cover;'">
                        <div class="container">
                            <div class="row align-items-center">
                                <div class="col-lg-8 mx-auto text-center">
                                    <h1 class="display-4 fw-bold mb-4 animate-fade-in-up text-white">Món ngon trứ danh ngày Tết Việt</h1>
                                    <p class="lead mb-4 animate-fade-in-up animate-delay-1 text-white">
                                        Hương vị béo ngậy, thơm lừng của lạp xưởng mang đậm dấu ấn ẩm thực truyền thống, thường xuất hiện trong mâm cơm sum vầy ngày Tết.
                                    </p>
                                    <a th:href="@{/products}" class="btn btn-warning btn-lg px-5 py-3 animate-fade-in-up animate-delay-2">
                                        <i class="bi bi-cart-plus me-2"></i>Tìm hiểu ngay
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Slide 2 -->
                <div class="carousel-item">
                    <div class="hero-slide" th:style="'background: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url(' + @{/images/slider/slider-2.webp} + ') center/cover;'">
                        <div class="container">
                            <div class="row align-items-center">
                                <div class="col-lg-8 mx-auto text-center">
                                    <h1 class="display-4 fw-bold mb-4 text-white">Đặc Sản Quê Hương</h1>
                                    <p class="lead mb-4 text-white">
                                        Khám phá hương vị đặc trưng từ khắp các vùng miền Việt Nam với những sản phẩm chất lượng cao.
                                    </p>
                                    <a th:href="@{/products}" class="btn btn-light btn-lg px-5 py-3">
                                        <i class="bi bi-grid me-2"></i>Khám Phá Ngay
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Slide 3 -->
                <div class="carousel-item">
                    <div class="hero-slide" th:style="'background: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url(' + @{/images/slider/slider-3.webp} + ') center/cover;'">
                        <div class="container">
                            <div class="row align-items-center">
                                <div class="col-lg-8 mx-auto text-center">
                                    <h1 class="display-4 fw-bold mb-4 text-white">Giao Hàng Toàn Quốc</h1>
                                    <p class="lead mb-4 text-white">
                                        Miễn phí giao hàng nội thành cho đơn hàng từ 300.000đ. Cam kết chất lượng và độ tươi ngon.
                                    </p>
                                    <a th:href="@{/products}" class="btn btn-light btn-lg px-5 py-3">
                                        <i class="bi bi-truck me-2"></i>Đặt Hàng Ngay
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon"></span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon"></span>
            </button>
        </div>
    </section>
    
    <!-- Service Features -->
    <section class="py-4 bg-light">
        <div class="container">
            <div class="row g-4">
                <div class="col-lg-3 col-md-6">
                    <div class="text-center">
                        <div class="feature-icon-centered mb-3 mx-auto d-flex align-items-center justify-content-center" style="width: 90px; height: 90px;">
                            <i class="fas fa-shipping-fast" style="font-size: 3.5rem; color: #5ec4b6;"></i>
                        </div>
                        <h6 class="fw-bold mb-2" style="color: #5ec4b6; font-size: 1.1rem;">Giao hàng miễn phí</h6>
                        <p class="text-muted mb-0" style="font-size: 0.9rem;">Miễn phí giao hàng nội thành cho đơn hàng từ 300.000đ</p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="text-center">
                        <div class="feature-icon-centered mb-3 mx-auto d-flex align-items-center justify-content-center" style="width: 90px; height: 90px;">
                            <i class="fas fa-headset" style="font-size: 3.5rem; color: #5ec4b6;"></i>
                        </div>
                        <h6 class="fw-bold mb-2" style="color: #5ec4b6; font-size: 1.1rem;">Hỗ trợ 24/7</h6>
                        <p class="text-muted mb-0" style="font-size: 0.9rem;">Hotline hỗ trợ 24/7 tất cả ngày trong tuần</p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="text-center">
                        <div class="feature-icon-centered mb-3 mx-auto d-flex align-items-center justify-content-center" style="width: 90px; height: 90px;">
                            <i class="fas fa-sync-alt" style="font-size: 3.5rem; color: #5ec4b6;"></i>
                        </div>
                        <h6 class="fw-bold mb-2" style="color: #5ec4b6; font-size: 1.1rem;">7 ngày đổi trả</h6>
                        <p class="text-muted mb-0" style="font-size: 0.9rem;">Cam kết chất lượng bảo đổi trả trong vòng 7 ngày</p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="text-center">
                        <div class="feature-icon-centered mb-3 mx-auto d-flex align-items-center justify-content-center" style="width: 90px; height: 90px;">
                            <i class="fas fa-shield-alt" style="font-size: 3.5rem; color: #5ec4b6;"></i>
                        </div>
                        <h6 class="fw-bold mb-2" style="color: #5ec4b6; font-size: 1.1rem;">Thanh toán an toàn</h6>
                        <p class="text-muted mb-0" style="font-size: 0.9rem;">Đảm bảo thanh toán an toàn với MoMo, VNPay, ZaloPay</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Categories Section -->
    <section class="py-5 bg-light">
        <div class="container">
            <div class="text-center mb-5">
                <h2 class="section-title" style="color: #4ec2b6; font-weight: 800;">
                    <i class="bi bi-grid-3x3-gap me-2"></i>DANH MỤC SẢN PHẨM
                </h2>
                <p class="section-subtitle" style="color: #2c3e50; font-weight: 500;">Khám phá đặc sản từ khắp ba miền Việt Nam</p>
            </div>
            
            <!-- Dynamic Categories from Database -->
            <div class="row g-4" th:if="${categories != null and !categories.empty}">
                <div class="col-lg-3 col-md-6" th:each="category, iterStat : ${categories}">
                    <a th:href="@{/products(categoryId=${category.id})}" class="text-decoration-none" th:title="${'Xem sản phẩm ' + category.name}">
                        <div class="card modern-card h-100 category-card-hover animate-fade-in-up" 
                             th:attr="style='overflow: hidden; border-radius: 15px; animation-delay: ' + ${iterStat.index * 0.1} + 's'">
                            <div class="position-relative" style="height: 200px; overflow: hidden;">
                                <img th:src="${category.imageUrl != null ? category.imageUrl : 'https://files.catbox.moe/h0vshx.webp'}" 
                                     th:alt="${category.name}"
                                     class="card-img-top" 
                                     style="height: 100%; object-fit: cover; transition: transform 0.3s;"
                                     onerror="this.src='https://files.catbox.moe/h0vshx.webp'">
                                <div class="position-absolute top-0 start-0 w-100 h-100" 
                                     style="background: linear-gradient(to bottom, rgba(0,0,0,0.3), rgba(0,0,0,0.6));">
                                </div>
                                <div class="position-absolute bottom-0 start-0 w-100 p-3">
                                    <h5 class="fw-bold mb-1 text-uppercase" style="color: #4ec2b6; text-shadow: 3px 3px 8px rgba(0,0,0,0.9), 0 0 10px rgba(0,0,0,0.7); font-size: 1.1rem; letter-spacing: 0.5px;" th:text="${category.name}">Category Name</h5>
                                    <p class="small mb-0 text-white" style="text-shadow: 2px 2px 6px rgba(0,0,0,0.9), 0 0 8px rgba(0,0,0,0.7); font-weight: 500;" th:text="${category.description != null ? category.description : 'Khám phá ngay'}">Description</p>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
            
            <!-- Fallback Static Categories -->
            <div class="row g-4" th:if="${categories == null or categories.empty}">
                <div class="col-lg-3 col-md-6">
                    <a href="/products" class="text-decoration-none">
                        <div class="card modern-card h-100 category-card-hover" style="overflow: hidden; border-radius: 15px;">
                            <div class="position-relative" style="height: 200px; overflow: hidden;">
                                <img src="https://images.unsplash.com/photo-1567620905732-2d1ec7ab7445?w=400&q=80" 
                                     class="card-img-top" style="height: 100%; object-fit: cover; transition: transform 0.3s;" alt="Đặc Sản">
                                <div class="position-absolute top-0 start-0 w-100 h-100" 
                                     style="background: linear-gradient(to bottom, rgba(0,0,0,0.3), rgba(0,0,0,0.6));">
                                </div>
                                <div class="position-absolute bottom-0 start-0 w-100 p-3">
                                    <h5 class="fw-bold mb-1" style="color: #4ec2b6; text-shadow: 3px 3px 8px rgba(0,0,0,0.9), 0 0 10px rgba(0,0,0,0.7); font-size: 1.1rem; letter-spacing: 0.5px;">TẤT CẢ SẢN PHẨM</h5>
                                    <p class="small mb-0 text-white" style="text-shadow: 2px 2px 6px rgba(0,0,0,0.9), 0 0 8px rgba(0,0,0,0.7); font-weight: 500;">Khám phá ngay</p>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </section>
    
    <!-- New Products Section -->
    <section class="py-5">
        <div class="container">
            <div class="text-center mb-5">
                <h2 class="section-title text-primary">
                    <i class="bi bi-stars me-2"></i>SẢN PHẨM MỚI
                </h2>
                <p class="section-subtitle text-muted">Những sản phẩm mới nhất vừa được cập nhật</p>
            </div>
            
            <!-- Dynamic New Products from Database -->
            <div class="row g-4" id="newProductsContainer" th:if="${newProducts != null and !newProducts.empty}">
                <div class="col-lg-3 col-md-6 product-item" th:each="product, iterStat : ${newProducts}" th:attr="data-index=${iterStat.index}">
                    <div class="card modern-card product-card h-100 animate-fade-in-up" th:attr="style='animation-delay: ' + ${(iterStat.index % 8) * 0.1} + 's'">
                        <div class="position-relative">
                            <img th:src="${product.imageUrl}" 
                                 th:alt="${product.name}"
                                 class="card-img-top product-img" 
                                 onerror="this.src='https://images.unsplash.com/photo-1567620905732-2d1ec7ab7445?w=300&q=80'">
                            <div class="product-badge">
                                <span class="badge bg-danger mb-1">
                                    <i class="bi bi-lightning-fill me-1"></i>Mới
                                </span>
                                <span class="badge bg-warning" th:if="${product.stockQuantity <= 10 and product.stockQuantity > 0}">
                                    <i class="bi bi-exclamation-triangle me-1"></i>Sắp hết
                                </span>
                            </div>
                        </div>
                        <div class="card-body p-4">
                            <h5 class="card-title fw-bold mb-2" th:text="${product.name}">Tên sản phẩm</h5>
                            <p class="card-text text-muted mb-3" th:utext="${product.description}">Mô tả sản phẩm</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="price-tag" th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT')} + '₫'">0₫</span>
                                <button class="btn btn-primary btn-sm px-3" 
                                        th:disabled="${product.stockQuantity == 0}"
                                        th:attr="data-product-id=${product.id}">
                                    <i class="bi bi-cart-plus me-1"></i>Thêm
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Pagination -->
            <div class="d-flex justify-content-center align-items-center gap-2 mt-5" id="productPagination" th:if="${newProducts != null and newProducts.size() >= 8}" style="display: none !important;">
                <button id="prevPage" class="btn" style="background: #6c757d; border: none; color: white; width: 45px; height: 45px; border-radius: 8px; font-size: 1.2rem; padding: 0; transition: all 0.3s; display: flex; align-items: center; justify-content: center;">
                    <i class="bi bi-chevron-left"></i>
                </button>
                <div id="pageNumbers" class="d-flex gap-2"></div>
                <button id="nextPage" class="btn" style="background: #6c757d; border: none; color: white; width: 45px; height: 45px; border-radius: 8px; font-size: 1.2rem; padding: 0; transition: all 0.3s; display: flex; align-items: center; justify-content: center;">
                    <i class="bi bi-chevron-right"></i>
                </button>
            </div>
            
            <style>
                #prevPage:hover:not(:disabled), #nextPage:hover:not(:disabled) {
                    background: #4ec2b6 !important;
                    transform: scale(1.05);
                }
                
                #prevPage:disabled, #nextPage:disabled {
                    opacity: 0.3;
                    cursor: not-allowed;
                }
                
                .page-number {
                    background: #e9ecef;
                    color: #6c757d;
                    width: 45px;
                    height: 45px;
                    border-radius: 8px;
                    font-weight: 600;
                    font-size: 1.1rem;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    cursor: pointer;
                    transition: all 0.3s;
                    border: none;
                }
                
                .page-number:hover {
                    background: #4ec2b6;
                    color: white;
                    transform: scale(1.05);
                }
                
                .page-number.active {
                    background: #4ec2b6;
                    color: white;
                }
            </style>
            
            <!-- Fallback Static New Products -->
            <div class="row g-4" th:if="${newProducts == null or newProducts.empty}">
                <div class="col-lg-3 col-md-6">
                    <div class="card modern-card product-card h-100">
                        <div class="position-relative">
                            <img src="https://images.unsplash.com/photo-1586190848861-99aa4a171e90?w=300&q=80" 
                                 class="card-img-top product-img" alt="Bánh chưng">
                            <div class="product-badge">
                                <span class="badge bg-danger">
                                    <i class="bi bi-lightning-fill me-1"></i>Mới
                                </span>
                            </div>
                        </div>
                        <div class="card-body p-4">
                            <h5 class="card-title fw-bold mb-2">Bánh Chưng Truyền Thống</h5>
                            <p class="card-text text-muted mb-3">Gạo nếp, đậu xanh, thịt heo</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="price-tag">150.000₫</span>
                                <button class="btn btn-primary btn-sm px-3">
                                    <i class="bi bi-cart-plus me-1"></i>Thêm
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="card modern-card product-card h-100">
                        <div class="position-relative">
                            <img src="https://images.unsplash.com/photo-1565299624946-b28f40a0ca4b?w=300&q=80" 
                                 class="card-img-top product-img" alt="Nem chua">
                            <div class="product-badge">
                                <span class="badge bg-danger">
                                    <i class="bi bi-lightning-fill me-1"></i>Mới
                                </span>
                            </div>
                        </div>
                        <div class="card-body p-4">
                            <h5 class="card-title fw-bold mb-2">Nem Chua Thanh Hóa</h5>
                            <p class="card-text text-muted mb-3">Thịt heo tươi, gia vị đặc biệt</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="price-tag">80.000₫</span>
                                <button class="btn btn-primary btn-sm px-3">
                                    <i class="bi bi-cart-plus me-1"></i>Thêm
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="card modern-card product-card h-100">
                        <div class="position-relative">
                            <img src="https://images.unsplash.com/photo-1559847844-d721426d6edc?w=300&q=80" 
                                 class="card-img-top product-img" alt="Bánh tráng">
                            <div class="product-badge">
                                <span class="badge bg-danger">
                                    <i class="bi bi-lightning-fill me-1"></i>Mới
                                </span>
                            </div>
                        </div>
                        <div class="card-body p-4">
                            <h5 class="card-title fw-bold mb-2">Bánh Tráng Nướng Đà Lạt</h5>
                            <p class="card-text text-muted mb-3">Giòn rụm, tương ớt đặc biệt</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="price-tag">45.000₫</span>
                                <button class="btn btn-primary btn-sm px-3">
                                    <i class="bi bi-cart-plus me-1"></i>Thêm
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="card modern-card product-card h-100">
                        <div class="position-relative">
                            <img src="https://images.unsplash.com/photo-1569718212165-3a8278d5f624?w=300&q=80" 
                                 class="card-img-top product-img" alt="Bún bò Huế">
                            <div class="product-badge">
                                <span class="badge bg-danger">
                                    <i class="bi bi-lightning-fill me-1"></i>Mới
                                </span>
                            </div>
                        </div>
                        <div class="card-body p-4">
                            <h5 class="card-title fw-bold mb-2">Bún Bò Huế (Gói gia vị)</h5>
                            <p class="card-text text-muted mb-3">Đậm đà, cay nồng đặc trưng</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="price-tag">35.000₫</span>
                                <button class="btn btn-primary btn-sm px-3">
                                    <i class="bi bi-cart-plus me-1"></i>Thêm
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Featured Products Section -->
    <section class="py-5 bg-light featured-products-section">
        <div class="container">
            <div class="text-center mb-5">
                <h2 class="section-title text-warning">
                    <i class="bi bi-star-fill me-2"></i>SẢN PHẨM NỔI BẬT
                </h2>
                <p class="section-subtitle text-muted">Những sản phẩm được yêu thích nhất</p>
            </div>
            
            <!-- Dynamic Products from Database -->
            <div class="row g-4" th:if="${featuredProducts != null and !featuredProducts.empty}">
                <div class="col-lg-3 col-md-6" th:each="product, iterStat : ${featuredProducts}">
                    <div class="card modern-card product-card h-100 animate-fade-in-up" th:attr="style='animation-delay: ' + ${iterStat.index * 0.1} + 's'">
                        <div class="position-relative">
                            <img th:src="${product.imageUrl}" 
                                 th:alt="${product.name}"
                                 class="card-img-top product-img" 
                                 onerror="this.src='https://images.unsplash.com/photo-1567620905732-2d1ec7ab7445?w=300&q=80'">
                            <div class="product-badge">
                                <span class="badge bg-success mb-1" th:if="${product.isFeatured}">
                                    <i class="bi bi-star-fill me-1"></i>Nổi bật
                                </span>
                                <span class="badge bg-warning" th:if="${product.stockQuantity <= 10 and product.stockQuantity > 0}">
                                    <i class="bi bi-exclamation-triangle me-1"></i>Sắp hết
                                </span>
                            </div>
                        </div>
                        <div class="card-body p-4">
                            <h5 class="card-title fw-bold mb-2" th:text="${product.name}">Tên sản phẩm</h5>
                            <p class="card-text text-muted mb-3" th:utext="${product.description}">Mô tả sản phẩm</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="price-tag" th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT')} + '₫'">0₫</span>
                                <button class="btn btn-primary btn-sm px-3" 
                                        th:disabled="${product.stockQuantity == 0}"
                                        th:attr="data-product-id=${product.id}">
                                    <i class="bi bi-cart-plus me-1"></i>Thêm
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Fallback Static Products -->
            <div class="row g-4" th:if="${featuredProducts == null or featuredProducts.empty}">
                <div class="col-lg-3 col-md-6">
                    <div class="card modern-card product-card h-100">
                        <div class="position-relative">
                            <img src="https://images.unsplash.com/photo-1586190848861-99aa4a171e90?w=300&q=80" 
                                 class="card-img-top product-img" alt="Bánh chưng">
                            <div class="product-badge">
                                <span class="badge bg-success">
                                    <i class="bi bi-star-fill me-1"></i>Nổi bật
                                </span>
                            </div>
                        </div>
                        <div class="card-body p-4">
                            <h5 class="card-title fw-bold mb-2">Bánh Chưng Truyền Thống</h5>
                            <p class="card-text text-muted mb-3">Gạo nếp, đậu xanh, thịt heo</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="price-tag">150.000₫</span>
                                <button class="btn btn-primary btn-sm px-3">
                                    <i class="bi bi-cart-plus me-1"></i>Thêm
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="card modern-card product-card h-100">
                        <div class="position-relative">
                            <img src="https://images.unsplash.com/photo-1565299624946-b28f40a0ca4b?w=300&q=80" 
                                 class="card-img-top product-img" alt="Nem chua">
                            <div class="product-badge">
                                <span class="badge bg-success">
                                    <i class="bi bi-star-fill me-1"></i>Nổi bật
                                </span>
                            </div>
                        </div>
                        <div class="card-body p-4">
                            <h5 class="card-title fw-bold mb-2">Nem Chua Thanh Hóa</h5>
                            <p class="card-text text-muted mb-3">Thịt heo tươi, gia vị đặc biệt</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="price-tag">80.000₫</span>
                                <button class="btn btn-primary btn-sm px-3">
                                    <i class="bi bi-cart-plus me-1"></i>Thêm
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="card modern-card product-card h-100">
                        <div class="position-relative">
                            <img src="https://images.unsplash.com/photo-1559847844-d721426d6edc?w=300&q=80" 
                                 class="card-img-top product-img" alt="Bánh tráng">
                            <div class="product-badge">
                                <span class="badge bg-success">
                                    <i class="bi bi-star-fill me-1"></i>Nổi bật
                                </span>
                            </div>
                        </div>
                        <div class="card-body p-4">
                            <h5 class="card-title fw-bold mb-2">Bánh Tráng Nướng Đà Lạt</h5>
                            <p class="card-text text-muted mb-3">Giòn rụm, tương ớt đặc biệt</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="price-tag">45.000₫</span>
                                <button class="btn btn-primary btn-sm px-3">
                                    <i class="bi bi-cart-plus me-1"></i>Thêm
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="card modern-card product-card h-100">
                        <div class="position-relative">
                            <img src="https://images.unsplash.com/photo-1569718212165-3a8278d5f624?w=300&q=80" 
                                 class="card-img-top product-img" alt="Bún bò Huế">
                            <div class="product-badge">
                                <span class="badge bg-success">
                                    <i class="bi bi-star-fill me-1"></i>Nổi bật
                                </span>
                            </div>
                        </div>
                        <div class="card-body p-4">
                            <h5 class="card-title fw-bold mb-2">Bún Bò Huế (Gói gia vị)</h5>
                            <p class="card-text text-muted mb-3">Đậm đà, cay nồng đặc trưng</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="price-tag">35.000₫</span>
                                <button class="btn btn-primary btn-sm px-3">
                                    <i class="bi bi-cart-plus me-1"></i>Thêm
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="text-center mt-5">
                <a th:href="@{/products}" class="btn btn-primary btn-lg px-5 py-3">
                    Xem Tất Cả Sản Phẩm <i class="bi bi-arrow-right ms-2"></i>
                </a>
            </div>
        </div>
    </section>
    
    <!-- Call to Action Section -->
    <section class="py-5" style="background: linear-gradient(135deg, #4ec2b6 0%, #2e857c 100%); position: relative; overflow: hidden;">
        <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; opacity: 0.1; background-image: url('data:image/svg+xml,%3Csvg width=\'60\' height=\'60\' viewBox=\'0 0 60 60\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cg fill=\'none\' fill-rule=\'evenodd\'%3E%3Cg fill=\'%23ffffff\' fill-opacity=\'1\'%3E%3Cpath d=\'M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z\'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E');"></div>
        <div class="container position-relative">
            <div class="row align-items-center g-4">
                <div class="col-lg-7">
                    <div class="text-white">
                        <div class="d-inline-block mb-3 px-3 py-2 rounded-pill" style="background: rgba(255,255,255,0.2);">
                            <i class="fas fa-gift me-2"></i>
                            <span class="fw-semibold">Ưu Đãi Đặc Biệt</span>
                        </div>
                        <h2 class="fw-bold mb-3" style="font-size: 2.5rem; line-height: 1.2;">
                            Giảm Ngay 15% Cho Đơn Hàng Đầu Tiên!
                        </h2>
                        <p class="lead mb-4" style="font-size: 1.1rem; opacity: 0.95;">
                            Áp dụng cho đơn hàng từ 500.000đ. Miễn phí giao hàng toàn quốc. 
                            Khám phá hương vị đặc sản từ khắp ba miền Việt Nam ngay hôm nay!
                        </p>
                        <div class="d-flex gap-3 flex-wrap">
                            <div class="d-flex align-items-center gap-2 px-3 py-2 rounded" style="background: rgba(255,255,255,0.15);">
                                <i class="fas fa-clock" style="font-size: 1.2rem;"></i>
                                <span>Có hiệu lực đến 31/12/2025</span>
                            </div>
                            <div class="d-flex align-items-center gap-2 px-3 py-2 rounded" style="background: rgba(255,255,255,0.15);">
                                <i class="fas fa-shipping-fast" style="font-size: 1.2rem;"></i>
                                <span>Miễn phí vận chuyển</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-5">
                    <div class="text-center">
                        <div class="d-grid gap-3">
                            <a th:href="@{/products}" class="btn btn-light btn-lg fw-bold py-3 px-4 shadow" 
                               style="border-radius: 12px; font-size: 1.1rem;">
                                <i class="fas fa-shopping-cart me-2"></i>Mua Ngay - Giảm 15%
                            </a>
                            <a th:href="@{/register}" class="btn btn-outline-light btn-lg py-3 px-4" 
                               style="border-radius: 12px; border-width: 2px; font-size: 1.1rem;">
                                <i class="fas fa-user-plus me-2"></i>Đăng Ký Thành Viên
                            </a>
                        </div>
                        <p class="text-white mt-3 mb-0" style="font-size: 0.9rem; opacity: 0.8;">
                            <i class="fas fa-shield-alt me-1"></i>
                            Đã có hơn 10,000+ khách hàng tin tưởng
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- News & Social Section -->
    <section class="py-5 bg-light">
        <div class="container">
            <div class="row g-5">
                <!-- News Column -->
                <div class="col-lg-6">
                    <div class="h-100">
                        <h3 class="fw-bold mb-4 text-primary">
                            <i class="bi bi-newspaper me-2"></i>Tin Tức Mới Nhất
                        </h3>
                        
                        <div class="news-list">
                            <article class="news-item mb-4 p-4 bg-white rounded-3 shadow-sm">
                                <div class="row g-3">
                                    <div class="col-4">
                                        <img src="https://images.unsplash.com/photo-1586190848861-99aa4a171e90?w=200&q=80" 
                                             class="img-fluid rounded" alt="Tin tức">
                                    </div>
                                    <div class="col-8">
                                        <h5 class="fw-bold mb-2">
                                            <a href="#" class="text-decoration-none text-dark">
                                                Khám phá đặc sản Tết Nguyên Đán 2024
                                            </a>
                                        </h5>
                                        <p class="text-muted small mb-2">
                                            Những món ăn truyền thống không thể thiếu trong mâm cơm ngày Tết...
                                        </p>
                                        <div class="d-flex justify-content-between align-items-center">
                                            <small class="text-muted">
                                                <i class="bi bi-calendar me-1"></i>15/12/2024
                                            </small>
                                            <a href="#" class="btn btn-sm btn-outline-primary">Đọc thêm</a>
                                        </div>
                                    </div>
                                </div>
                            </article>
                            
                            <article class="news-item mb-4 p-4 bg-white rounded-3 shadow-sm">
                                <div class="row g-3">
                                    <div class="col-4">
                                        <img src="https://images.unsplash.com/photo-1565299624946-b28f40a0ca4b?w=200&q=80" 
                                             class="img-fluid rounded" alt="Tin tức">
                                    </div>
                                    <div class="col-8">
                                        <h5 class="fw-bold mb-2">
                                            <a href="#" class="text-decoration-none text-dark">
                                                Bí quyết bảo quản đặc sản tươi ngon
                                            </a>
                                        </h5>
                                        <p class="text-muted small mb-2">
                                            Hướng dẫn cách bảo quản các loại đặc sản để giữ được hương vị tốt nhất...
                                        </p>
                                        <div class="d-flex justify-content-between align-items-center">
                                            <small class="text-muted">
                                                <i class="bi bi-calendar me-1"></i>12/12/2024
                                            </small>
                                            <a href="#" class="btn btn-sm btn-outline-primary">Đọc thêm</a>
                                        </div>
                                    </div>
                                </div>
                            </article>
                            
                            <article class="news-item mb-4 p-4 bg-white rounded-3 shadow-sm">
                                <div class="row g-3">
                                    <div class="col-4">
                                        <img src="https://images.unsplash.com/photo-1559847844-d721426d6edc?w=200&q=80" 
                                             class="img-fluid rounded" alt="Tin tức">
                                    </div>
                                    <div class="col-8">
                                        <h5 class="fw-bold mb-2">
                                            <a href="#" class="text-decoration-none text-dark">
                                                Chương trình khuyến mãi tháng 12
                                            </a>
                                        </h5>
                                        <p class="text-muted small mb-2">
                                            Giảm giá lên đến 30% cho tất cả sản phẩm đặc sản miền Nam...
                                        </p>
                                        <div class="d-flex justify-content-between align-items-center">
                                            <small class="text-muted">
                                                <i class="bi bi-calendar me-1"></i>10/12/2024
                                            </small>
                                            <a href="#" class="btn btn-sm btn-outline-primary">Đọc thêm</a>
                                        </div>
                                    </div>
                                </div>
                            </article>
                        </div>
                        
                        <div class="text-center">
                            <a href="#" class="btn btn-primary">
                                Xem Tất Cả Tin Tức <i class="bi bi-arrow-right ms-1"></i>
                            </a>
                        </div>
                    </div>
                </div>
                
                <!-- Social & Contact Column -->
                <div class="col-lg-6">
                    <div class="h-100">
                        <!-- Social Media Section -->
                        <div class="mb-5">
                            <h3 class="fw-bold mb-4 text-success">
                                <i class="bi bi-share me-2"></i>Kết Nối Với Chúng Tôi
                            </h3>
                            
                            <div class="row g-3 mb-4">
                                <div class="col-6">
                                    <a href="#" class="btn btn-primary w-100 py-3 d-flex align-items-center justify-content-center">
                                        <i class="bi bi-facebook fs-4 me-2"></i>
                                        <div class="text-start">
                                            <div class="fw-bold">Facebook</div>
                                            <small>50K+ Followers</small>
                                        </div>
                                    </a>
                                </div>
                                <div class="col-6">
                                    <a href="#" class="btn btn-danger w-100 py-3 d-flex align-items-center justify-content-center">
                                        <i class="bi bi-youtube fs-4 me-2"></i>
                                        <div class="text-start">
                                            <div class="fw-bold">YouTube</div>
                                            <small>25K+ Subscribers</small>
                                        </div>
                                    </a>
                                </div>
                                <div class="col-6">
                                    <a href="#" class="btn btn-info w-100 py-3 d-flex align-items-center justify-content-center">
                                        <i class="bi bi-instagram fs-4 me-2"></i>
                                        <div class="text-start">
                                            <div class="fw-bold">Instagram</div>
                                            <small>30K+ Followers</small>
                                        </div>
                                    </a>
                                </div>
                                <div class="col-6">
                                    <a href="#" class="btn btn-dark w-100 py-3 d-flex align-items-center justify-content-center">
                                        <i class="bi bi-tiktok fs-4 me-2"></i>
                                        <div class="text-start">
                                            <div class="fw-bold">TikTok</div>
                                            <small>15K+ Followers</small>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Contact Form Section -->
                        <div class="bg-white p-4 rounded-3 shadow-sm">
                            <h4 class="fw-bold mb-3 text-warning">
                                <i class="bi bi-chat-dots me-2"></i>Để Lại Thông Tin Tư Vấn
                            </h4>
                            <p class="text-muted mb-4">
                                Chúng tôi sẽ liên hệ tư vấn miễn phí về sản phẩm phù hợp với nhu cầu của bạn.
                            </p>
                            
                            <form class="consultation-form">
                                <div class="mb-3">
                                    <label class="form-label fw-semibold">Họ và tên *</label>
                                    <input type="text" class="form-control" placeholder="Nhập họ tên của bạn" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label fw-semibold">Số điện thoại *</label>
                                    <input type="tel" class="form-control" placeholder="Nhập số điện thoại" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label fw-semibold">Email</label>
                                    <input type="email" class="form-control" placeholder="Nhập email (không bắt buộc)">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label fw-semibold">Nhu cầu tư vấn</label>
                                    <select class="form-select">
                                        <option value="">Chọn loại sản phẩm quan tâm</option>
                                        <option value="mien-bac">Đặc sản miền Bắc</option>
                                        <option value="mien-trung">Đặc sản miền Trung</option>
                                        <option value="mien-nam">Đặc sản miền Nam</option>
                                        <option value="tet">Sản phẩm Tết</option>
                                        <option value="qua-tang">Quà tặng doanh nghiệp</option>
                                    </select>
                                </div>
                                <div class="mb-4">
                                    <label class="form-label fw-semibold">Ghi chú thêm</label>
                                    <textarea class="form-control" rows="3" placeholder="Mô tả chi tiết nhu cầu của bạn..."></textarea>
                                </div>
                                <button type="submit" class="btn btn-warning w-100 fw-bold py-3">
                                    <i class="bi bi-send me-2"></i>Gửi Thông Tin Tư Vấn
                                </button>
                                <p class="small text-muted mb-0" style="margin-top: 12px; padding-top: 8px;">
                                    <i class="bi bi-shield-check me-1"></i>
                                    Thông tin của bạn được bảo mật tuyệt đối
                                </p>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Footer -->
    <div th:replace="~{fragments/footer :: footer}"></div>
    
    <script>
        // Consultation Form Handler
        document.querySelector('.consultation-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form data
            const formData = new FormData(this);
            const name = this.querySelector('input[type="text"]').value;
            const phone = this.querySelector('input[type="tel"]').value;
            const email = this.querySelector('input[type="email"]').value;
            const category = this.querySelector('select').value;
            const note = this.querySelector('textarea').value;
            
            // Basic validation
            if (!name || !phone) {
                alert('Vui lòng nhập đầy đủ họ tên và số điện thoại!');
                return;
            }
            
            // Phone validation
            const phoneRegex = /^[0-9]{10,11}$/;
            if (!phoneRegex.test(phone.replace(/\s/g, ''))) {
                alert('Số điện thoại không hợp lệ!');
                return;
            }
            
            // Show loading
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="bi bi-hourglass-split me-2"></i>Đang gửi...';
            submitBtn.disabled = true;
            
            // Send to backend
            fetch('/api/consultation', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    name: name,
                    phone: phone,
                    email: email,
                    interest: category,
                    message: note
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.message) {
                    showModal('Thành công!', data.message, 'success');
                    this.reset();
                } else if (data.error) {
                    showModal('Lỗi!', data.error, 'error');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                showModal('Lỗi!', 'Có lỗi xảy ra. Vui lòng thử lại sau!', 'error');
            })
            .finally(() => {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            });
        });
        
        // Add intersection observer for animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate-fade-in-up');
                }
            });
        }, observerOptions);
        
        // Observe elements for animation
        document.querySelectorAll('.modern-card, .news-item').forEach(el => {
            observer.observe(el);
        });
    </script>
    
    <!-- Common Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script th:src="@{/js/cart-manager.js(v=1)}"></script>
    <script th:src="@{/js/cart-sync.js(v=1)}"></script>
    <script th:src="@{/js/cart-animations-v2.js(v=1)}"></script>
    <script th:src="@{/js/header.js(v=1)}"></script>
    <script th:src="@{/js/cursor-trail.js(v=1)}"></script>
    <script th:src="@{/js/card-3d-effect.js(v=1)}"></script>
    <script th:src="@{/js/ecommerce-enhanced.js(v=1)}"></script>
    
    <!-- Success/Error Modal -->
    <div class="modal fade" id="responseModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="border: none; border-radius: 20px; overflow: hidden; box-shadow: 0 10px 40px rgba(0,0,0,0.15);">
                <div class="modal-header" id="modalHeader" style="border: none; padding: 40px 30px 25px; position: relative;">
                    <div style="width: 100%; text-align: center;">
                        <div id="modalIcon" style="font-size: 72px; margin-bottom: 15px;"></div>
                        <h5 class="modal-title" id="modalTitle" style="font-weight: 700; font-size: 24px; margin: 0;"></h5>
                    </div>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close" 
                            style="position: absolute; top: 15px; right: 15px; opacity: 0.8;"></button>
                </div>
                <div class="modal-body" style="padding: 0 40px 40px; text-align: center;">
                    <p id="modalMessage" style="margin: 0; padding: 0 20px; font-size: 16px; color: #666; line-height: 1.6;"></p>
                </div>
            </div>
        </div>
    </div>
    
    <style>
        #responseModal .modal-content {
            animation: modalSlideIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        @keyframes checkmarkAnimation {
            0% {
                transform: scale(0) rotate(0deg);
                opacity: 0;
            }
            50% {
                transform: scale(1.2) rotate(180deg);
            }
            100% {
                transform: scale(1) rotate(360deg);
                opacity: 1;
            }
        }
        
        @keyframes errorAnimation {
            0% {
                transform: scale(0) rotate(0deg);
                opacity: 0;
            }
            50% {
                transform: scale(1.2) rotate(-10deg);
            }
            100% {
                transform: scale(1) rotate(0deg);
                opacity: 1;
            }
        }
        
        #modalIcon.animate-success {
            animation: checkmarkAnimation 0.6s ease-out;
        }
        
        #modalIcon.animate-error {
            animation: errorAnimation 0.5s ease-out;
        }
        
        #responseModal .btn-close-white:hover {
            opacity: 1 !important;
        }
    </style>
    
    <script>
        function showModal(title, message, type) {
            const modal = new bootstrap.Modal(document.getElementById('responseModal'));
            const modalHeader = document.getElementById('modalHeader');
            const modalIcon = document.getElementById('modalIcon');
            const modalTitle = document.getElementById('modalTitle');
            const modalMessage = document.getElementById('modalMessage');
            const closeBtn = modalHeader.querySelector('.btn-close');
            
            // Reset animation
            modalIcon.className = '';
            
            modalTitle.textContent = title;
            modalMessage.textContent = message;
            
            if (type === 'success') {
                modalHeader.style.background = 'linear-gradient(135deg, #4ec2b6 0%, #2e857c 100%)';
                modalHeader.style.color = 'white';
                modalIcon.innerHTML = '<i class="fas fa-check-circle"></i>';
                modalIcon.classList.add('animate-success');
                closeBtn.classList.add('btn-close-white');
            } else {
                modalHeader.style.background = 'linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%)';
                modalHeader.style.color = 'white';
                modalIcon.innerHTML = '<i class="fas fa-times-circle"></i>';
                modalIcon.classList.add('animate-error');
                closeBtn.classList.add('btn-close-white');
            }
            
            modal.show();
        }
    </script>
    
    <!-- Product Pagination Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const itemsPerPage = 8;
            let currentPage = 1;
            const productItems = document.querySelectorAll('.product-item');
            const totalPages = Math.ceil(productItems.length / itemsPerPage);
            const paginationContainer = document.getElementById('productPagination');
            
            // If no products or pagination not needed, exit
            if (productItems.length === 0 || productItems.length <= itemsPerPage) {
                return;
            }
            
            // Show pagination
            paginationContainer.style.display = 'flex';
            
            const prevBtn = document.getElementById('prevPage');
            const nextBtn = document.getElementById('nextPage');
            const pageNumbersContainer = document.getElementById('pageNumbers');
            
            // Create page number buttons
            function createPageNumbers() {
                pageNumbersContainer.innerHTML = '';
                for (let i = 1; i <= totalPages; i++) {
                    const pageBtn = document.createElement('button');
                    pageBtn.className = 'page-number';
                    pageBtn.textContent = i;
                    pageBtn.addEventListener('click', () => showPage(i));
                    pageNumbersContainer.appendChild(pageBtn);
                }
            }
            
            function showPage(page, shouldScroll = true) {
                currentPage = page;
                
                // Hide all items
                productItems.forEach(item => {
                    item.style.display = 'none';
                });
                
                // Show items for current page
                const start = (page - 1) * itemsPerPage;
                const end = start + itemsPerPage;
                
                for (let i = start; i < end && i < productItems.length; i++) {
                    productItems[i].style.display = 'block';
                    // Re-trigger animation
                    const card = productItems[i].querySelector('.animate-fade-in-up');
                    if (card) {
                        card.style.animation = 'none';
                        setTimeout(() => {
                            card.style.animation = `fadeInUp 0.6s ease-out ${(i - start) * 0.1}s both`;
                        }, 10);
                    }
                }
                
                // Update pagination UI - highlight active page
                document.querySelectorAll('.page-number').forEach((btn, index) => {
                    if (index + 1 === page) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                });
                
                // Update button states
                prevBtn.disabled = (page === 1);
                nextBtn.disabled = (page === totalPages);
                
                // Smooth scroll to products section (only when changing pages)
                if (shouldScroll) {
                    document.getElementById('newProductsContainer').scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'start' 
                    });
                }
                
                // Event delegation in ecommerce-enhanced.js handles all add-to-cart buttons
                // No need to re-attach listeners here
            }
            
            // Create page numbers
            createPageNumbers();
            
            // Event listeners
            prevBtn.addEventListener('click', function() {
                if (currentPage > 1) {
                    showPage(currentPage - 1);
                }
            });
            
            nextBtn.addEventListener('click', function() {
                if (currentPage < totalPages) {
                    showPage(currentPage + 1);
                }
            });
            
            // Initialize first page (without scrolling)
            showPage(1, false);
        });
    </script>
    
    <!-- Product Image Hover Effect Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 3D Tilt Effect for Featured Products
            const featuredSection = document.querySelector('.featured-products-section');
            
            if (featuredSection) {
                const featuredCards = featuredSection.querySelectorAll('.product-card');
                
                featuredCards.forEach((card) => {
                    let currentRotateX = 0;
                    let currentRotateY = 0;
                    let targetRotateX = 0;
                    let targetRotateY = 0;
                    let animationFrame = null;
                    
                    // Smooth animation function with easing
                    function animate() {
                        // Lerp (linear interpolation) with higher factor for ultra-smooth transition
                        currentRotateX += (targetRotateX - currentRotateX) * 0.15;
                        currentRotateY += (targetRotateY - currentRotateY) * 0.15;
                        
                        const transformValue = `translateY(-12px) rotateX(${currentRotateX}deg) rotateY(${currentRotateY}deg) scale(1.05)`;
                        card.style.setProperty('transform', transformValue, 'important');
                        
                        // Continue animation if not close enough to target
                        if (Math.abs(targetRotateX - currentRotateX) > 0.05 || Math.abs(targetRotateY - currentRotateY) > 0.05) {
                            animationFrame = requestAnimationFrame(animate);
                        }
                    }
                    
                    card.addEventListener('mousemove', function(e) {
                        const rect = card.getBoundingClientRect();
                        const x = e.clientX - rect.left;
                        const y = e.clientY - rect.top;
                        
                        const centerX = rect.width / 2;
                        const centerY = rect.height / 2;
                        
                        // Reversed and very subtle sensitivity (divided by 20 for smoother effect)
                        targetRotateX = -(y - centerY) / 20;  // Negative to reverse
                        targetRotateY = (x - centerX) / 20;   // Positive to reverse
                        
                        card.style.setProperty('box-shadow', '0 25px 50px rgba(0, 0, 0, 0.2)', 'important');
                        
                        // Start animation if not already running
                        if (!animationFrame) {
                            animationFrame = requestAnimationFrame(animate);
                        }
                    });
                    
                    card.addEventListener('mouseleave', function() {
                        targetRotateX = 0;
                        targetRotateY = 0;
                        
                        // Smooth return to original position with easing
                        function returnToOriginal() {
                            currentRotateX += (0 - currentRotateX) * 0.2;
                            currentRotateY += (0 - currentRotateY) * 0.2;
                            
                            const transformValue = `translateY(0) rotateX(${currentRotateX}deg) rotateY(${currentRotateY}deg) scale(1)`;
                            card.style.setProperty('transform', transformValue, 'important');
                            
                            if (Math.abs(currentRotateX) > 0.05 || Math.abs(currentRotateY) > 0.05) {
                                requestAnimationFrame(returnToOriginal);
                            } else {
                                card.style.setProperty('transform', 'translateY(0) rotateX(0) rotateY(0) scale(1)', 'important');
                                currentRotateX = 0;
                                currentRotateY = 0;
                            }
                        }
                        
                        card.style.setProperty('box-shadow', '', 'important');
                        if (animationFrame) {
                            cancelAnimationFrame(animationFrame);
                            animationFrame = null;
                        }
                        requestAnimationFrame(returnToOriginal);
                    });
                });
            }
            
            // Get all product cards for image hover
            const productCards = document.querySelectorAll('.product-card');
            
            productCards.forEach(card => {
                const imgElement = card.querySelector('.product-img');
                if (!imgElement) return;
                
                const productId = card.querySelector('[data-product-id]')?.getAttribute('data-product-id');
                if (!productId) return;
                
                // Fetch additional images for this product
                fetch(`/api/products/${productId}/images`)
                    .then(response => response.json())
                    .then(images => {
                        if (images && images.length > 0) {
                            const secondImage = images[0];
                            
                            const hoverImg = document.createElement('img');
                            hoverImg.src = secondImage.imageUrl;
                            hoverImg.alt = 'Product hover image';
                            hoverImg.className = 'card-img-top product-img product-img-hover';
                            hoverImg.onerror = function() {
                                this.style.display = 'none';
                            };
                            
                            const imgContainer = imgElement.parentElement;
                            if (!imgContainer.classList.contains('product-img-container')) {
                                const container = document.createElement('div');
                                container.className = 'product-img-container';
                                imgElement.parentNode.insertBefore(container, imgElement);
                                container.appendChild(imgElement);
                                container.appendChild(hoverImg);
                            } else {
                                imgContainer.appendChild(hoverImg);
                            }
                        }
                    })
                    .catch(error => {
                        console.log('No additional images for product', productId);
                    });
            });
        });
    </script>
</body>
</html></small>